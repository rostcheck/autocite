GPT-4 Technical Report

OpenAI

Abstract

We report the development of GPT-4, a large-scale, multimodal model which can 
accept image and text inputs and produce text outputs. While less capable than 
humans in many real-world scenarios, GPT-4 exhibits human-level performance 
on various professional and academic benchmarks, including passing a simulated 
bar exam with a score around the top 10% of test takers. GPT-4 is a Transformer-
based model pre-trained to predict the next token in a document. The post-training 
alignment process results in improved performance on measures of factuality and 
adherence to desired behavior. A core component of this project was developing 
infrastructure and optimization methods that behave predictably across a wide 
range of scales. This allowed us to accurately predict some aspects of GPT-4's 
performance based on models trained with no more than 1/1,000th the compute of 
GPT-4.

Introduction

This technical report presents GPT-4, a large multimodal model capable of processing image and
text inputs and producing text outputs. Such models are an important area of study as they have the
potential to be used in a wide range of applications, such as dialogue systems, text summarization,
and machine translation. As such, they have been the subject of substantial interest and progress in
recent years [1–34].

One of the main goals of developing such models is to improve their ability to understand and generate
natural language text, particularly in more complex and nuanced scenarios. To test its capabilities
in such scenarios, GPT-4 was evaluated on a variety of exams originally designed for humans. In
these evaluations it performs quite well and often outscores the vast majority of human test takers.
For example, on a simulated bar exam, GPT-4 achieves a score that falls in the top 10% of test takers. 
This contrasts with GPT-3.5, which scores in the bottom 10%.

On a suite of traditional NLP benchmarks, GPT-4 outperforms both previous large language models
and most state-of-the-art systems (which often have benchmark-specific training or hand-engineering).
On the MMLU benchmark [35, 36], an English-language suite of multiple-choice questions covering
57 subjects, GPT-4 not only outperforms existing models by a considerable margin in English, but
also demonstrates strong performance in other languages. On translated variants of MMLU, GPT-4
surpasses the English-language state-of-the-art in 24 of 26 languages considered. We discuss these
model capability results, as well as model safety improvements and results, in more detail in later
sections.

This report also discusses a key challenge of the project, developing deep learning infrastructure and
optimization methods that behave predictably across a wide range of scales. This allowed us to make
predictions about the expected performance of GPT-4 (based on small runs trained in similar ways)
that were tested against the final run to increase confidence in our training.

Despite its capabilities, GPT-4 has similar limitations to earlier GPT models [1, 37, 38]: it is not fully
reliable (e.g. can suffer from "hallucinations"), has a limited context window, and does not learn
from experience. Care should be taken when using the outputs of GPT-4, particularly in contexts
where reliability is important.

GPT-4's capabilities and limitations create significant and novel safety challenges, and we believe
careful study of these challenges is an important area of research given the potential societal impact.
This report includes an extensive system card (after the Appendix) describing some of the risks we
foresee around bias, disinformation, over-reliance, privacy, cybersecurity, proliferation, and more.
It also describes interventions we made to mitigate potential harms from the deployment of GPT-4,
including adversarial testing with domain experts, and a model-assisted safety pipeline.

Scope and Limitations of this Technical Report

This report focuses on the capabilities, limitations, and safety properties of GPT-4. GPT-4 is a
Transformer-style model [39] pre-trained to predict the next token in a document, using both publicly
available data (such as internet data) and data licensed from third-party providers. The model was
then fine-tuned using Reinforcement Learning from Human Feedback (RLHF) [40]. Given both
the competitive landscape and the safety implications of large-scale models like GPT-4, this report
contains no further details about the architecture (including model size), hardware, training compute,
dataset construction, training method, or similar.

We are committed to independent auditing of our technologies, and shared some initial steps and
ideas in this area in the system card accompanying this release.2 We plan to make further technical
details available to additional third parties who can advise us on how to weigh the competitive and
safety considerations above against the scientific value of further transparency.

Predictable Scaling

A large focus of the GPT-4 project was building a deep learning stack that scales predictably. The
primary reason is that for very large training runs like GPT-4, it is not feasible to do extensive
model-specific tuning. To address this, we developed infrastructure and optimization methods that
have very predictable behavior across multiple scales. These improvements allowed us to reliably
predict some aspects of the performance of GPT-4 from smaller models trained using 1,000-10,000
times less compute.

Loss Prediction

The final loss of properly-trained large language models is thought to be well approximated by power
laws in the amount of compute used to train the model [41, 42, 2, 14, 15].

To verify the scalability of our optimization infrastructure, we predicted GPT-4's final loss on our
internal codebase (not part of the training set) by fitting a scaling law with an irreducible loss term
(as in Henighan et al. [15]): L(C) = aC^b + c, from models trained using the same methodology
but using at most 10,000x less compute than GPT-4. This prediction was made shortly after the run
started, without use of any partial results. The fitted scaling law predicted GPT-4's final loss with
high accuracy (Figure 1).

Scaling of Capabilities on HumanEval

Having a sense of the capabilities of a model before training can improve decisions around alignment,
safety, and deployment. In addition to predicting final loss, we developed methodology to predict
more interpretable metrics of capability. One such metric is pass rate on the HumanEval dataset [43],
which measures the ability to synthesize Python functions of varying complexity. We successfully
predicted the pass rate on a subset of the HumanEval dataset by extrapolating from models trained
with at most 1,000 times less compute (Figure 2).

For an individual problem in HumanEval, performance may occasionally worsen with scale. Despite 
these challenges, we find an approximate power law relationship

E_P[log(pass_rate(C))] = α - k * log(C)

where k and α are positive constants, and P is a subset of problems in the dataset. We hypothesize
that this relationship holds for all problems in this dataset. In practice, very low pass rates are difficult
or impossible to estimate, so we restrict to problems P and models M such that given some large
sample budget, every problem is solved at least once by every model.

We registered predictions for GPT-4's performance on HumanEval before training completed, using
only information available prior to training. All but the 15 hardest HumanEval problems were split
into 6 difficulty buckets based on the performance of smaller models. The results on the 3rd easiest
bucket are shown in Figure 2, showing that the resulting predictions were very accurate for this
subset of HumanEval problems where we can accurately estimate log(pass_rate) for several smaller
models. Predictions on the other five buckets performed almost as well, the main exception being
GPT-4 underperforming our predictions on the easiest bucket.

Certain capabilities remain hard to predict. For example, the Inverse Scaling Prize [44] proposed
several tasks for which model performance decreases as a function of scale. Similarly to a recent
result by Wei et al. [45], we find that GPT-4 reverses this trend, as shown on one of the tasks called
Hindsight Neglect [46] in Figure 3.

We believe that accurately predicting future capabilities is important for safety. Going forward we
plan to refine these methods and register performance predictions across various capabilities before
large model training begins, and we hope this becomes a common goal in the field.

Capabilities

We tested GPT-4 on a diverse set of benchmarks, including simulating exams that were originally
designed for humans.4 We did no specific training for these exams. A minority of the problems in the
exams were seen by the model during training; for each exam we run a variant with these questions
removed and report the lower score of the two. We believe the results to be representative. For further
details on contamination (methodology and per-exam statistics), see Appendix C.

Exams were sourced from publicly-available materials. Exam questions included both multiple-
choice and free-response questions; we designed separate prompts for each format, and images were
included in the input for questions which required it. The evaluation setup was designed based
on performance on a validation set of exams, and we report final results on held-out test exams.
Overall scores were determined by combining multiple-choice and free-response question scores
using publicly available methodologies for each exam. We estimate and report the percentile each
overall score corresponds to. See Appendix A for further details on the exam evaluation methodology.

GPT-4 exhibits human-level performance on the majority of these professional and academic exams.
Notably, it passes a simulated version of the Uniform Bar Examination with a score in the top 10% of
test takers (Table 1, Figure 4).

The model's capabilities on exams appear to stem primarily from the pre-training process and are not
significantly affected by RLHF. On multiple choice questions, both the base GPT-4 model and the
RLHF model perform equally well on average across the exams we tested (see Appendix B).

We also evaluated the pre-trained base GPT-4 model on traditional benchmarks designed for evaluating
language models. For each benchmark we report, we ran contamination checks for test data appearing
in the training set (see Appendix D for full details on per-benchmark contamination).5 We used
few-shot prompting [1] for all benchmarks when evaluating GPT-4.6

GPT-4 considerably outperforms existing language models, as well as previously state-of-the-art
(SOTA) systems which often have benchmark-specific crafting or additional training protocols
(Table 2).

Many existing ML benchmarks are written in English. To gain an initial understanding of GPT-4's
capabilities in other languages, we translated the MMLU benchmark [35, 36] – a suite of multiple-
choice problems spanning 57 subjects – into a variety of languages using Azure Translate (see
Appendix F for example translations and prompts). We find that GPT-4 outperforms the English-
language performance of GPT 3.5 and existing language models (Chinchilla [2] and PaLM [3]) for
the majority of languages we tested, including low-resource languages such as Latvian, Welsh, and
Swahili (Figure 5).

GPT-4 substantially improves over previous models in the ability to follow user intent [63]. On
a dataset of 5,214 prompts submitted to ChatGPT [64] and the OpenAI API [47], the responses
generated by GPT-4 were preferred over the responses generated by GPT-3.5 on 70.2% of prompts.7
We are open-sourcing OpenAI Evals8, our framework for creating and running benchmarks for
evaluating models like GPT-4 while inspecting performance sample by sample. Evals is compatible
with existing benchmarks, and can be used to track performance of models in deployment. We plan
to increase the diversity of these benchmarks over time to represent a wider set of failure modes and
a harder set of tasks.

Visual Inputs

GPT-4 accepts prompts consisting of both images and text, which – parallel to the text-only setting
– lets the user specify any vision or language task. Specifically, the model generates text outputs
given inputs consisting of arbitrarily interlaced text and images. Over a range of domains – including
documents with text and photographs, diagrams, or screenshots – GPT-4 exhibits similar capabilities
as it does on text-only inputs. An example of GPT-4's visual input can be found in Table 3. The
standard test-time techniques developed for language models (e.g. few-shot prompting, chain-of-
thought, etc) are similarly effective when using both images and text - see Appendix G for examples.

Preliminary results on a narrow set of academic vision benchmarks can be found in the GPT-4 blog
post [65]. We plan to release more information about GPT-4's visual capabilities in follow-up work.

Limitations

Despite its capabilities, GPT-4 has similar limitations as earlier GPT models. Most importantly, it still
is not fully reliable (it "hallucinates" facts and makes reasoning errors). Great care should be taken
when using language model outputs, particularly in high-stakes contexts, with the exact protocol
(such as human review, grounding with additional context, or avoiding high-stakes uses altogether)
matching the needs of specific applications. See our System Card for details.

GPT-4 significantly reduces hallucinations relative to previous GPT-3.5 models (which have them-
selves been improving with continued iteration). GPT-4 scores 19 percentage points higher than our
latest GPT-3.5 on our internal, adversarially-designed factuality evaluations (Figure 6).

GPT-4 makes progress on public benchmarks like TruthfulQA [66], which tests the model's ability to
separate fact from an adversarially-selected set of incorrect statements (Figure 7). These questions
are paired with factually incorrect answers that are statistically appealing. The GPT-4 base model is
only slightly better at this task than GPT-3.5; however, after RLHF post-training we observe large
improvements over GPT-3.5.9 Table 4 shows both a correct and an incorrect answer. GPT-4 resists
selecting common sayings (you can't teach an old dog new tricks), however it still can miss subtle
details (Elvis Presley was not the son of an actor, so Perkins is the correct answer).

GPT-4 generally lacks knowledge of events that have occurred after the vast majority of its pre-training
data cuts off in September 2021, and does not learn from its experience. It can sometimes make
simple reasoning errors which do not seem to comport with competence across so many domains, or
be overly gullible in accepting obviously false statements from a user. It can fail at hard problems the
same way humans do, such as introducing security vulnerabilities into code it produces.

GPT-4 can also be confidently wrong in its predictions, not taking care to double-check work when
it's likely to make a mistake. Interestingly, the pre-trained model is highly calibrated (its predicted
confidence in an answer generally matches the probability of being correct). However, after the
post-training process, the calibration is reduced (Figure 8).

GPT-4 has various biases in its outputs that we have taken efforts to correct but which will take
some time to fully characterize and manage. We aim to make GPT-4 and other systems we build
have reasonable default behaviors that reflect a wide swath of users' values, allow those systems
to be customized within some broad bounds, and get public input on what those bounds should be. 
See OpenAI [68] for more details.

Risks & mitigations

We invested significant effort towards improving the safety and alignment of GPT-4. Here we
highlight our use of domain experts for adversarial testing and red-teaming, and our model-assisted
safety pipeline [69] and the improvement in safety metrics over prior models.

Adversarial Testing via Domain Experts: GPT-4 poses similar risks as smaller language models,
such as generating harmful advice, buggy code, or inaccurate information. However, the additional
capabilities of GPT-4 lead to new risk surfaces. To understand the extent of these risks, we engaged
over 50 experts from domains such as long-term AI alignment risks, cybersecurity, biorisk, and
international security to adversarially test the model. Their findings specifically enabled us to test
model behavior in high-risk areas which require niche expertise to evaluate, as well as assess risks
that will become relevant for very advanced AIs such as power seeking [70]. Recommendations and
training data gathered from these experts fed into our mitigations and improvements for the model;
for example, we've collected additional data to improve GPT-4's ability to refuse requests on how to
synthesize dangerous chemicals (Table 5).

Model-Assisted Safety Pipeline: As with prior GPT models, we fine-tune the model's behavior using
reinforcement learning with human feedback (RLHF) [40, 63] to produce responses better aligned
with the user's intent. However, after RLHF, our models can still be brittle on unsafe inputs as well as
sometimes exhibit undesired behaviors on both safe and unsafe inputs. These undesired behaviors can
arise when instructions to labelers were underspecified during reward model data collection portion
of the RLHF pipeline. When given unsafe inputs, the model may generate undesirable content, such
as giving advice on committing crimes. Furthermore, the model may also become overly cautious
on safe inputs, refusing innocuous requests or excessively hedging. To steer our models towards
appropriate behaviour at a more fine-grained level, we rely heavily on our models themselves as tools.
Our approach to safety consists of two main components, an additional set of safety-relevant RLHF
training prompts, and rule-based reward models (RBRMs).

Our rule-based reward models (RBRMs) are a set of zero-shot GPT-4 classifiers. These classifiers
provide an additional reward signal to the GPT-4 policy model during RLHF fine-tuning that targets
correct behavior, such as refusing to generate harmful content or not refusing innocuous requests.
The RBRM takes three inputs: the prompt (optional), the output from the policy model, and a
human-written rubric (e.g., a set of rules in multiple-choice style) for how this output should be
evaluated. Then, the RBRM classifies the output based on the rubric. For example, we can provide a
rubric that instructs the model to classify a response as one of: (a) a refusal in the desired style, (b) a
refusal in the undesired style (e.g., evasive or rambling), (c) containing disallowed content, or (d) a
safe non-refusal response. Then on the set of safety-relevant training prompts, which request harmful
content such as illicit advice, we can reward GPT-4 for refusing these requests. Conversely, we can
reward GPT-4 for not refusing requests on a subset of prompts guaranteed to be safe and answerable.
This technique is related to work by Glaese et al. [71] and Perez et al. [72]. This, combined with
other improvements such as computing optimal RBRM weights and providing additional SFT data
targeting the areas we want to improve, allowed us to steer the model closer towards the desired
behaviour.

Improvements on Safety Metrics: Our mitigations have significantly improved many of GPT-4's
safety properties. We've decreased the model's tendency to respond to requests for disallowed content
(Table 6) by 82% compared to GPT-3.5, and GPT-4 responds to sensitive requests (e.g., medical
advice and self-harm, Table 7) in accordance with our policies 29% more often (Figure 9). On the
RealToxicityPrompts dataset [73], GPT-4 produces toxic generations only 0.73% of the time, while
GPT-3.5 generates toxic content 6.48% of time.

Overall, our model-level interventions increase the difficulty of eliciting bad behavior but doing so
is still possible. For example, there still exist "jailbreaks" (e.g., adversarial system messages, see
Figure 10 in the System Card for more details) to generate content which violate our usage guidelines.
So long as these limitations exist, it's important to complement them with deployment-time safety
techniques like monitoring for abuse as well as a pipeline for fast iterative model improvement.

GPT-4 and successor models have the potential to significantly influence society in both beneficial
and harmful ways. We are collaborating with external researchers to improve how we understand and
assess potential impacts, as well as to build evaluations for dangerous capabilities that may emerge in
future systems. We will soon publish recommendations on steps society can take to prepare for AI's
effects and initial ideas for projecting AI's possible economic impacts.

Conclusion

We characterize GPT-4, a large multimodal model with human-level performance on certain difficult
professional and academic benchmarks. GPT-4 outperforms existing large language models on a
collection of NLP tasks, and exceeds the vast majority of reported state-of-the-art systems (which
often include task-specific fine-tuning). We find that improved capabilities, whilst usually measured
in English, can be demonstrated in many different languages. We highlight how predictable scaling
allowed us to make accurate predictions on the loss and capabilities of GPT-4.

GPT-4 presents new risks due to increased capability, and we discuss some of the methods and results
taken to understand and improve its safety and alignment. Though there remains much work to be
done, GPT-4 represents a significant step towards broadly useful and safely deployed AI systems.